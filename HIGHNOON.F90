! Run: gfortran -ffree-form -fdollar-ok HIGHNOON.F90 -o HIGHNOON

PROGRAM HIGHNOON
IMPLICIT NONE

INTEGER A, B, C, F, I, P, Q, R, S, T, W, X, Z
REAL AR, D
CHARACTER(100) A$, D$, H$

! DESIGNED AND PROGRAMMED BY CHRIS GAYLO, SYOSSET H.S.--9/12/70
! TRANSLATED TO FORTRAN BY EVGENY STEPANISCHEV, --2020/09/17 (BOLKNOTE.RU)
110 PRINT "(A37)", "H I G H  N O O N"
120 PRINT "(A37,/,/)", "----------------"
150 WRITE (*, "(A)", advance="no") " DO YOU WANT INSTRUCTIONS? "
160 READ *, D$
170 IF (D$ == "NO" .OR. D$ == "no") GOTO 330
200 PRINT "(/,/,A)", " YOU HAVE BEEN CHALLENGED TO A SHOWDOWN BY BLACK BART, ONE OF"
210 PRINT *, "THE MEANEST DESPERADOES WEST OF THE ALLEGHENY MOUNTAINS."
220 PRINT *, "WHILE YOU ARE WALKING DOWN A DUSTY, DESERTED SIDE STREET,"
230 PRINT *, "BLACK BART EMERGES FROM A SALOON ONE HUNDRED PACES AWAY. BY"
240 PRINT *, "AGREEMENT, YOU EACH HAVE FOUR CARTRIDGES IN YOUR SIX-GUNS."
250 PRINT *, "YOUR MARKSMANSHIP EQUALS HIS. AT THE START OF THE WALKM NEI-"
260 PRINT *, "THER OF YOU CAN POSSIBLY HIT THE OTHER, AND AT THE END OF"
270 PRINT *, "THE WALK, NEITHER CAN MISS. THE CLOSER YOU GET, THE BETTER"
280 PRINT *, "YOUR CHANCES OF HITTING BART, BUT HE ALSO HAS BETER CHANCES"
290 PRINT *, "OF HITTING YOU."
300 WRITE (*, "(/,A)", advance="no") " DO YOU STILL WANT TO CONTINUE? "
310 READ *, A$
320 IF (A$ == "NO" .OR. A$ == "no") GOTO 1370
330 PRINT "(A,/,/)", "THE MOVES ARE AS FOLLOWS:"
360 PRINT "(A36)", "*M O V E S*"
370 PRINT "(A36,/)", "==========="
390 PRINT "(A35,/)", "1. ADVANCE"
410 PRINT "(A,A39,/)", "2. STAND STILL", "3. FIRE"
430 PRINT "(A,A22,/)", "4. JUMP BEHIND THE WATERING TROUGH", "5. GIVE UP"
450 PRINT "(A45,/,/)", "6. TURN TAIL AND RUN"
540 X = 100
550 WRITE (*, "(/,/,A)", advance="no") " WHAT IS YOUR STRATEGY? "
570 READ *, B
590 IF (B > 6) GOTO 1340
600 IF (B < 1) GOTO 1340
610 GOTO (620, 1390, 690, 1410, 1510, 1610), B
620 WRITE (*, "(A)", advance="no") " HOW MANY PACES DO YOU ADVANCE: "
630 READ *, S
640 IF (S < 0) GOTO 2000
650 IF (S > 10) GOTO 1980
660 X = X - S
670 PRINT *, "YOU ARE NOW ", Itoa(X), " PACES APART."
680 GOTO 1040
690 C = C + 1
700 IF (C <= 4) GOTO 750
710 PRINT *, "NICE GOING, ACE, YOU'VE RUN OUT OF SHELLS."
720 PRINT *, "NOW BART WON'T SHOOT UNTIL YOU TOUCH NOSES."
730 PRINT *, "YOU BETTER THINK OF SOMETHING FAST. (LIKE RUN)"
740 GOTO 1040
750 W = RAND(1) * 10
760 IF (W > X / 10) GOTO 820
770 IF (C == 2) GOTO 1820
780 IF (C == 3) GOTO 1840
790 PRINT *, "WHAT A LOUSY SHOT."
800 IF (C == 4) GOTO 710
810 GOTO 1460
820 PRINT *, "WHAT A SHOT, YOU GOT BLACK BART RIGHT BETWEEN THE EYES."
850 PRINT "(/,/,A)", " AS MAYOR OF DODGE CITY, AND ON BEHALF OF ITS CITIZENS,"
860 PRINT *, "I EXTEND TO YOU OUR THANKS, AND PRESENT YOU WITH THIS"
870 PRINT *, "REWARD, A CHECK FOR $20,000, FOR KILLING BLACK BART."
890 PRINT "(/,A)", "******************************************************"
900 D = RAND(1)
910 PRINT "(/,2A,A30,2A)", "CHECK NO. ", Itoa(INT(1000 * D)), " AUG. ", Itoa(INT(10 + 10 * D)), " TH. 1889"
920 PRINT "(/, A50)", "CASHIER'S RECEIT---BANK OF DODsGE CITY"
940 PRINT "(/, A45)", "PAY TO THE BEARER ON DEMAND"
960 PRINT "(/, A35)", "THE SUM OF"
980 PRINT "(/, A54)", "TWENTY THOUSAND DOLLARS-------------------$20,000"
1000 PRINT "(/, A, /)", "******************************************************"
1020 PRINT *, "DON'T SPEND IT ALL IN ONE PLACE."
1030 GOTO 2080
1040 IF (X < 10) GOTO 1120
1050 Q = RAND(1) * 10
1060 IF (Q > 5) GOTO 1120
1070 Z = INT(2 + RAND(1) * 9)
1080 PRINT *, "BLACK BART MOVES ", Itoa(Z), " PACES"
1090 X = X - Z
1100 PRINT *, "YOU ARE NOW ", Itoa(X), " PACES APART"
1110 GOTO 550
1120 P = P + 1
1130 IF (C > 4) GOTO 1070
1140 IF (P <= 4) GOTO 1200
1150 IF (P == 5) GOTO 1180
1160 IF (P > 6) GOTO 2020
1170 GOTO 1070
1180 PRINT *, "NOW IS YOUR CHANCE, BART IS OUT OF SHELLS"
1190 GOTO 1070
1200 R = RAND(1) * 10
1210 PRINT *, "BART FIRES . . . . . ."
1220 IF (R > X / 10) GOTO 1300
1230 PRINT *, "A MISS . . . ."
1240 IF (P == 2) GOTO 1890
1250 IF (P == 3) GOTO 1940
1260 IF (P > 4) GOTO 1070
1270 IF (P == 4) GOTO 1960
1280 PRINT *, "WHEW, WERE YOU LUCKY. THAT BULLET JUST MISSED YOUR HEAD."
1290 GOTO 1490
1300 IF (B == 4) GOTO 1910
1310 PRINT *, "BART SHOT YOU RIGHT THROUGH THE HEART THAT TIME."
1320 PRINT *, "YOU WENT KICKIN' WITH YOUR BOOTS ON."
1330 GOTO 2080
1340 PRINT *, "YOU SURE AREN'T GOING TO LIVE VERY LONG IF YOU CAN'T EVEN"
1350 PRINT *, "FOLLOW DIRECTIONS"
1360 GOTO 550
1370 PRINT *, "GREENHORN."
1380 GOTO 2080
1390 PRINT *, "THAT MOVE MADE YOU A PERFECT STATIONARY TARGET"
1400 GOTO 1040
1410 T = T + 1
1420 IF (T > 3) GOTO 2060
1430 IF (T > 3) GOTO 2060
1440 PRINT *, "NOT A BAD MANEUVER, YOU THREW BART'S STRATEGY OFF"
1450 GOTO 1040
1460 IF (P > 4) GOTO 1050
1470 PRINT *, "YOU NOW HAVE", 4 - C, "SHELLS TO BART'S", 4 - P, "SHELLS."
1480 GOTO 1040
1490 PRINT *, "YOU NOW HAVE", 4 - C, "SHELLS TO BART'S", 4 - P, "SHELLS."
1500 GOTO 550
1510 PRINT *, "BLACK BART ACCEPTS. THE CONDITIONS ARE THAT HE WON'T SHOOT YOU"
1520 PRINT *, "IF YOU TAKE THE FIRST STAGE OUT OF TOWN AND NEVER COME BACK"
1530 WRITE (*, "(/,A)", advance="no") " AGREED? "
1540 READ *, H$
1550 IF (H$ == "NO" .OR. H$ == "no") GOTO 1590
1570 PRINT *, "A VERY WISE DECISION."
1580 GOTO 2080
1590 PRINT *, "OH WELL, BACK TO THE SHOWDOWN"
1600 GOTO 550
1610 WRITE (*, "(/,A)", advance="no") " HOW FAR DID YOU RUN? "
1620 READ *, F
1630 IF (F < 50) GOTO 1670
1640 PRINT *, "MAN, DID HE RUN. HE RAN SO FAST EVEN DOGS COULDN'T"
1650 PRINT *, "CATCH HIM"
1660 GOTO 2080
1670 IF (P >= 4) GOTO 1770
1680 PRINT *, "BLACK BART FIRES", 4 - P, "SHELLS......."
1690 IF (4 - P > 1) GOTO 1730
1700 PRINT *, "HE GOT YOU RIGHT IN THE BACK. THATS WHAT YOU DESERVE"
1710 PRINT *, "FOR RUNNING"
1720 GOTO 2080
1730 PRINT *, "BLACK BART UNLOADED HIS GUN, ONCE IN YOUR BACK"
1740 PRINT *, "AND", 3 - P, "TIMES IN YOUR A**. NOW YOU CAN'T EVEN REST IN"
1750 PRINT *, "PEACE."
1760 GOTO 2080
1770 PRINT *, "YOU WERE LUCKY, BART CAN ONLY THROW HIS GUN AT YOU, HE"
1780 PRINT *, "DOESN'T HAVE ANY SHELLS LEFT. YOU SHOULD REALLY BE DEAD."
1790 GOTO 2080
1800 IF (P == 2) GOTO 1940
1810 IF (P == 3) GOTO 1960
1820 PRINT *, "GRAZED BART IN THE RIGHT ARM"
1830 GOTO 1040
1840 PRINT *, "HE'S HIT IN THE LEFT SHOULDER, FORCING HIM TO USE HIS RIGHT"
1850 PRINT *, "HAND TO SHOOT WITH"
1860 GOTO 1040
1870 PRINT *, "THAT WAS YOUR LAST SHOT, YOU MISSED"
1880 GOTO 1040
1890 PRINT *, "BUT BART GOT YOU IN THE RIGHT SHIN."
1900 GOTO 550
1910 PRINT *, "THAT TRICK JUST SAVED YOUT LIFE. BART'S BULLET"
1920 PRINT *, "WAS STOPPED BY THE WOOD SIDES OF THE TROUGH."
1930 GOTO 550
1940 PRINT *, "THOUGH BART GOT YOU ON THE LEFT SIDE OF YOUR JAW."
1950 GOTO 550
1960 PRINT *, "BURT MUST HAVE JERKED THE TRIGGER"
1970 GOTO 550
1980 PRINT *, "NOBODY CAN WALK THAT FAST"
1990 GOTO 620
2000 PRINT *, "NONE OF THIS NEGATIVE STUFF PARTNER, ONLY POSITIVE NUMBERS"
2010 GOTO 620
2020 PRINT *, "BART JUST HI-TAILED IT OUT OF TOWN RATHER THAN FACE YOU WITH-"
2030 PRINT *, "OUT A LOADED GUN. YOU CAN REST ASSURED THAT BART WON'T EVER"
2040 PRINT *, "SHOW HIS FACE AROUND THIS TOWN AGAIN."
2050 GOTO 2080
2060 PRINT *, "HOW MANY WATERING TROUGHS DO YOU THINK ARE ON THIS STREET"
2070 GOTO 550
2080 PRINT "(/,A)", " C.G. INC."
! THE VARIABLE USAGE IS AS FOLLOWS:
!     D$--INSTRUCTION NEED
!     A$--INTENT TO CONTINUE THE GAME AFTER RECEIVNIG INSTRUCTIONS
!     A---STORES YOUR LUCKY NUMBER
!     I---USED FOR THE RANDOM GENERATOR
!     X---DENOTES THE DISTANCE BETWEEN YOU
!     B---DENOTES THE NUMBER OF YOUR MOVE
!     S---THE NUMBER OF PACES YOU ADVANCE
!     C---COUNTER FOR THE NUMBER OF YOU SHELLS
!     W---RANDOM NUMBER FOR HITTING OF BART
!     Q---RANDOM NUMBER FOR BART'S CHOICE OF WALK OR FIRE
!     Z---RANDOM NUMB BOR THE PACES BART ADVANCES
!     P---COUNTER FOR BART'S REMAINING SHELLS
!     R---RANDOM NUMBER FORBART HITTING YOU
!     T---COUNTER FOR THE NUMBER OF WATERING TROUGHS
!     F---DISTANCE YOU RUN
!     H$--DECISION ON GIVING UP

CONTAINS
    FUNCTION Itoa(num) RESULT(str)
        CHARACTER(:), ALLOCATABLE :: str
        INTEGER, INTENT(IN) :: num
        CHARACTER(RANGE(num) + 2) :: tmp

        WRITE (tmp, '(I0)') num
        str = TRIM(tmp)
    END

2270 END
